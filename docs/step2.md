# 2단계 - 렌더링 방식 탐구 및 비교 분석

## 랜더링 시점의 비교 🖌

### SPA

#### 특징

SPA는 Single Page Application의 약자로, 단일 페이지로 구성된 웹 애플리케이션을 의미합니다. SPA로 구성된 웹 페이지에서는 한 번 로딩할 때 서버로부터 페이지 구성에 필요한 모든 리소스를 한 번에 받으며, 이후 페이지를 이동할 때는 이미 받았던 리소스를 활용하여 페이지를 동적으로 다시 작성하는 방법입니다. 서버에서는 빈 HTML 파일과 번들 파일만 제공하며 이를 로딩하여 페이지를 작성하는 것은 클라이언트의 역할입니다.

#### 장/단점

- 페이지를 이동할 때 매번 서버에 모든 정보를 요청하는 것이 아닌, 가능한 한 이미 로드했던 리소스들을 재사용하여 페이지만 동적으로 바꾸는 방식이기에 트래픽이 덜하며 서버 부하가 적습니다. 페이지 이동도 빠릅니다.
- 클라이언트에서의 정보(로컬 스토리지) 등을 이용해야 하는 경우에도 좋은 선택이 될 것입니다. 서버에서 페이지를 내려주는 형태라면 서버에서는 해당 정보들을 활용할 수 없게 되죠.
- 초기 로딩 시간이 굉장히 긴 편입니다. 이는 서버로부터 필요한 모든 정적 리소스들을 한 번에 받아와야 하기 때문입니다. 이는 사용자 UX를 저하시킬 수 있습니다. 이러한 부담을 덜기 위해 필요에 따라 코드 스플리팅 등을 하기도 합니다.
- 페이지를 로딩하는 것은 클라이언트의 역할이기에 서버에서 내려주는 파일은 빈 HTML 파일과 번들 파일 뿐입니다. 이는 검색 엔진의 입장에서 사이트를 크롤링할 때 빈 페이지밖에 없는 웹 페이지로 보일 수 있기에 SEO 측면에서 좋지 못 한 방법입니다.

#### 적합하다고 생각하는 사용처

- 워크스페이스처럼 몇몇 페이지에서의 방문 및 전환이 빈번하게 반복될 만한 사이트. 한 번 받아온 리소스를 재사용하기 때문에 매번 서버 요청을 해야 하는 횟수가 줄어듭니다. 초기 로딩 속도야 느리겠지만 이로 인해 좋은 성능과 트래픽을 챙길 수야 있다면 충분히 좋은 trade-off가 될 수 있겠죠.
- 회원 전용 페이지 등 SEO가 별로 중요하지 않은 사이트. SEO 측면에서 좋지 못하다는 것은 SPA의 심각한 단점이 되지만, SEO가 애초부터 필요하지 않은 사이트라면 그게 단점이 될까요?

### SSR

SSR은 페이지의 로딩을 서버에서 부담하고, 브라우저가 매번 요청할 때마다 새로운 페이지를 만들어 브라우저에 응답하는 랜더링 방식입니다.

#### 장/단점

- 페이지가 생성되는 시점이 사용자가 요청할 때의 시점입니다. 그렇기에 생성된 페이지에 담긴 정보는 모두 최신의 정보임을 보장할 수 있죠.
- SEO 측면에서 훌륭합니다. 페이지를 로딩하는 것이 서버의 역할이기 때문입니다. 검색 엔진이 JavaScript를 실행시키지 않더라도 로드된 HTML 파일을 전달하므로 사이트의 내용을 충분히 읽을 수 있으며 JavaScript가 비활성화 되어 있어도 사용자가 원활하게 페이지의 내용을 확인할 수 있습니다.
- 서버 부담이 매우 심한 랜더링 방식입니다. 브라우저가 요청할 때마다 매번 페이지를 새로 만들어야 하기 때문입니다.
- 매번 페이지를 서버가 만들어 응답하므로 사이트의 성능도 좋지 못합니다. 이로 인해 사용자는 페이지 지연 현상을 겪을 수도 있으며, 이는 UX 저하로 이어질 수 있습니다.

#### 적합하다고 생각하는 사용처

- 인터넷 커뮤니티, API와 같이 성능이 어떻게 되어도 상관 없으니 사용자에게 항상 최신화된 정보만을 제공하는 것이 중요한 사이트. 댓글이 1초 전에 등록되었어도 항상 최신 정보를 보여줘야지요.
- SEO가 중요한 사이트. SEO가 중요한 사이트에 무턱대고 SPA를 사용했다가는 사용자 유입이 제대로 안 될 수도 있습니다.

### SSG

SSG는 SSR과 마찬가지로 페이지의 로딩을 서버에서 부담하지만, 브라우저가 요청할 때마다 매번 페이지를 새로 만드는 것은 아닙니다. 그 대신, 빌드 시간에 미리 페이지를 빌드해놓고 브라우저가 요청하면 미리 만들어 두었던 페이지를 사용하여 응답하는 방식입니다.

#### 장/단점

- 성능이 상당히 좋습니다. SSR과 달리 페이지를 매번 만들지 않고 빌드 시에 딱 한 번만 만들고 미리 만들어 두었던 페이지를 반환하니 서버의 응답 속도는 빠를 수밖에 없죠.
- SEO 측면에서 훌륭합니다. 페이지를 로딩하는 것이 서버의 역할이기 때문입니다. 검색 엔진이 JavaScript를 실행시키지 않더라도 로드된 HTML 파일을 전달하므로 사이트의 내용을 충분히 읽을 수 있으며 JavaScript가 비활성화 되어 있어도 사용자가 원활하게 페이지의 내용을 확인할 수 있습니다.
- 빌드 시에만 정적으로 생성되므로 사용자가 요청할 때마다 페이지에 최신화된 정보를 표시해야 하는 사이트에는 최악의 선택이 될 수 있습니다.
- 페이지의 수가 몇 천개와 같이 상당히 많은 경우에는 좋지 못한 선택이 될 수 있습니다. 빌드 시간에 페이지를 생성하게 될 텐데 빌드해야 할 페이지가 엄청나게 많다면 빌드 시간은 무진장 길어지겠죠.

#### 적합하다고 생각하는 사용처

- 랜딩 페이지, About 페이지 등 최신화된 정보를 제공해야 할 필요가 없고 잘 바뀌지 않는 사이트. SSG를 사용했을 경우 빌드 타임에 페이지를 생성해 최신화된 정보를 반영하지는 못 하지만 그게 별로 문제가 안 되는 사이트라면 단점은 상쇄되고 높은 성능만을 추구할 수 있습니다.
- SEO가 중요한 사이트. SEO가 중요한 사이트에 무턱대고 SPA를 사용했다가는 사용자 유입이 제대로 안 될 수도 있습니다.
- 최신화된 정보를 반영하여야 하지만 그 과정이 클라이언트에서 서버에 요청하는 것으로 최신화된 정보를 충분히 얻어낼 수 있는 사이트들. 정적인 부분은 SSG로 제공하고 바뀌어야 하는 부분은 클라이언트의 요청으로 반영할 수 있어 성능과 최신 정보 모두를 챙길 수 있어 보입니다.

### ISR

ISR은 SSG와 거의 비슷한 방식입니다. 페이지의 로딩을 서버에서 부담하고, 빌드 시간에 미리 페이지를 빌드해놓고 브라우저가 요청하면 미리 만들어 두었던 페이지를 사용하여 응답하는 방식이죠. 다만 다른 점은 ISR의 경우 `revalidate` 시간이 존재하여, 해당 시간이 경과하면 페이지를 다시 만든다는 특징이 있습니다.

#### 장/단점

- 제대로 사용하면 SSR과 SSG의 장점을 모두 이용할 수 있는 방법입니다. SSR과 같이 어느 정도 갱신된 정보들을 가져올 수 있으며 SSG와 같이 매번 브라우저의 요청이 있을 때마다 페이지를 매번 새로 만들 필요가 없습니다. 일종의 하이브리드 방식이기도 합니다.
- SEO 측면에서 훌륭합니다. 페이지를 로딩하는 것이 서버의 역할이기 때문입니다. 검색 엔진이 JavaScript를 실행시키지 않더라도 로드된 HTML 파일을 전달하므로 사이트의 내용을 충분히 읽을 수 있으며 JavaScript가 비활성화 되어 있어도 사용자가 원활하게 페이지의 내용을 확인할 수 있습니다.
- ISR을 사용하면 어느 정도 갱신된 정보들을 사용자에게 제공할 수 있지만 단 몇 초의 오차도 허용되지 않는 새로운 정보만을 사용자에게 제공해야 하는 경우에는 좋지 못한 선택이 될 수 있습니다. 완전히 최신화된 정보를 제공하지는 않기 때문입니다.
- SSG와도 공유하는 단점입니다만 페이지의 수가 몇 천개와 같이 상당히 많은 경우에는 좋지 못한 선택이 될 수 있습니다. 빌드 시간에 페이지를 생성하게 될 텐데 빌드해야 할 페이지가 엄청나게 많다면 빌드 시간은 무진장 길어지겠죠.

#### 적합하다고 생각하는 사용처

- 일간/주간 랭킹 사이트, 블로그 등 어느 정도 새로운 정보를 제공하여야 하지만 완전히 최신화된 정보일 필요는 없는 경우. 이 경우에는 SSR처럼 매번 페이지를 새롭게 만들면서 서버에 부하를 줄 필요가 없습니다. 서비스에 맞게 적절한 데이터 갱신 시간을 두고, 사용자가 너무 자주 요청할 경우에는 미리 빌드해두었던 정적인 페이지를 반환합시다. 정보가 조금 낡았다고 그게 그렇게 치명적이지는 않잖아요?
- SEO가 중요한 사이트. SEO가 중요한 사이트에 무턱대고 SPA를 사용했다가는 사용자 유입이 제대로 안 될 수도 있습니다.

### 사용자 경험(UX) 분석 🎶

여기에서는 저희의 팀 프로젝트 **팀바팀**을 이야기하고 각 페이지에 어떠한 랜더링 방식이 적용되면 좋을 것 같은지 저의 생각을 적어보고자 합니다.

팀바팀은 대학생 팀플 플랫폼입니다. 대부분의 페이지는 사용자가 팀 관련 작업을 하게 될 워크스페이스 페이지들로 이루어져 있습니다. 그리고, 사용자 유입을 위한 정적인 페이지들이 조금 있는데, 이는 랜딩 페이지와 개인정보처리방침 관련 페이지들이 있습니다.

우리의 서비스를 이용하게 될 사용자는 크게 두 부류로 나눌 수 있다고 생각합니다.

1. 팀바팀 서비스에 유입되는 사용자. 비로그인 사용자일 것이고, 주로 랜딩 페이지와 같은 페이지를 통해 유입되겠죠.
2. 팀바팀 서비스의 회원. 로그인 상태인 이상 이 부류의 사용자가 보게 될 페이지는 대부분 워크스페이스 관련 페이지입니다.

이를 생각해 보았을 때, 비로그인 사용자들이 보게 될 정적인 페이지에는 SSG를 적용하고, 로그인 사용자들이 보게 될 워크스페이스 페이지들에는 별도의 처리를 하지 않고 SPA를 유지시키는 것이 합리적인 선택일 것이라고 생각합니다.

#### 랜딩 페이지, 개인정보처리방침 페이지 (비로그인)

랜딩 페이지와 같은 정적인 페이지, 그리고 사용자가 자주 유입될 만한 페이지의 경우에는 SEO가 매우 중요할 것이며, 서버에서 이러한 페이지를 미리 랜더링해 준다면 사용자 유입에 굉장히 좋겠죠.

그러면 이제 SSR, ISR, SSG 중 적합한 방식을 선택해야 하는데, 랜딩 페이지, 개인정보처리방침 페이지와 같은 경우에는 내용이 바뀔 일이 없다시피 하며 사용자에게 어떠한 정보를 보여주더라도 이 정보가 자주 바뀌지도 않는 페이지들입니다. 정보가 조금 낡았다고 해도 치명적이지도 않고요. 우리가 다른 내용을 보여주기를 원한다면 그 때 새롭게 변경사항을 만들고 새롭게 빌드하면 그만이죠.

따라서 SSG를 사용하면 성능상의 이점을 누리면서 사용자의 유입도 향상시킬 수 있을 것이라 생각합니다.

#### 워크스페이스 페이지 (로그인)

여기서 워크스페이스 페이지란 로그인한 사용자가 팀플과 관련하여 작업을 할 페이지들입니다. 팀 캘린더 페이지, 팀 링크 페이지, 팀 피드 페이지 등이 될 수 있죠.

페이지의 목적과 사용자의 특성상, 이러한 페이지들은 사용자가 빈번하게 페이지를 전환하며 같은 레이아웃을 계속해서 로딩하는 것을 반복할 가능성이 높다고 보고 있습니다. 사용자가 페이지에 머무르는 시간도 상대적으로 길 것이라고 보고요.

이를 고려하였을 때는 초기 로딩 시간이 조금 길더라도 사용자의 입장에서는 어느 정도 납득할 수 있는 로딩 시간이 될 수 있을 것이라 생각합니다. 오히려 로딩 이후 워크스페이스 내의 페이지들을 빈번하게 전환할 때마다 매번 로딩을 하게 된다면 그게 사용자에게 더 안 좋은 UX를 제공할 수 있는 선택이 될 수 있어 보입니다.

또한 워크스페이스 페이지들은 로그인해야 접근할 수 있기에, 이 페이지들의 SEO를 챙기는 것은 별로 의미가 없어 보입니다. 새로운 사용자들을 이 페이지로 유입시켜서는 안 되니까요. 따라서 SEO 측면에서 불이익을 볼 수 있다는 점이 워크스페이스 페이지들에게는 단점으로 작용하지 않습니다.

따라서 워크스페이스 관련 페이지에는 별도의 수정을 거치지 않고 SPA 방식을 그대로 사용하면 좋을 것이라고 판단됩니다.

### 성능 측정 및 비교 📊

아래는 Next.js를 적용한 실제 팀바팀 서비스의 랜딩 페이지와 Next.js로 구현한 가짜 팀바팀 서비스의 랜딩 페이지의 성능을 비교한 결과입니다.

#### 성능 리포트(LightHouse)

1. 실제 팀바팀 서비스의 랜딩 페이지 (SPA)

![팀바팀](https://github.com/wzrabbit/frontend-rendering/assets/87642422/740a3e65-1dd4-4509-b68f-c4f8a6e113b4)

2. Next.js로 구현한 가짜 팀바팀 서비스의 랜딩 페이지 (SSG)

![짭바팀](https://github.com/wzrabbit/frontend-rendering/assets/87642422/fdac544c-b17c-4221-9f10-7de5a893fa1b)

#### 총평

- 워낙 가벼운 랜딩 페이지이다 보니까 성능의 변화가 별로 없을 줄 알았는데, 성능 점수를 나쁘지 않게 개선한 모습을 보였습니다.
- **LCP(Largest Contentful Paint) 시간을 대폭 개선할 수 있었습니다.** 랜딩 페이지에서 높은 LCP에 기여하는 폰트와 관련된 문제를 많이 해결할 수 있었어서 그런 것으로 추측합니다.
- **SEO를 개선할 수 있었습니다.** SSG 방식을 사용하여 JavaScript를 실행시키지 않는 검색 엔진에도 랜더링된 HTML 파일이 제공되기에 더 많은 정보를 줄 수 있습니다.
